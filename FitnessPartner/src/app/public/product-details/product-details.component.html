<!-- Product Details Section -->
<div class="product-details-container" *ngIf="product">
  <div class="breadcrumb-navigation">
    <a [routerLink]="['/']">Home</a> /  
    <!-- <a [routerLink]="['/products']">{{ product.category }}</a> /  -->
    <a [routerLink]="['/products']" [queryParams]="{ category: product.category} "> {{ product.category }}</a> /
    <span> {{ product.name }}</span>
  </div>

  <div class="product-content">
    <!-- Left Column - Product Images -->
    <div class="product-images">
      <div class="main-image">
        <div class="discount-badge" *ngIf="discountPercentage > 0">{{ discountPercentage }}% OFF</div>
        <img [src]="currentImage" [alt]="product.name" />
      </div>
      <div class="thumbnail-images" *ngIf="Object.keys(product.product_images).length > 0">
        <!-- Flavor-specific product images -->
        <div 
          class="thumbnail" 
          *ngFor="let flavor of product.available_flavors"
          (click)="changeImage(product.product_images[flavor])"
          [class.active]="currentImage === product.product_images[flavor]"
        >
          <img [src]="product.product_images[flavor]" [alt]="flavor" />
        </div>
      </div>
    </div>

    <!-- Right Column - Product Information -->
    <div class="product-info">
      <div class="stock-status">IN STOCK</div>
      
      <h1 class="product-title">{{ product.name }}</h1>
      
      <div class="product-meta">
        <span class="brand-label">Brands: <a [routerLink]="['/brand', product.brand]">{{ product.brand }}</a></span>
        <span class="sku-label">SKU: {{ product.id }}</span>
      </div>

      <div class="product-price">
        <span class="current-price">{{ product.price }} EGP</span>
      </div>

      <!-- Product Description -->
      <div class="product-description">
        <p>{{ product.description }}</p>
        <p>Expiration date: {{ product.expiration_date }}</p>
        <p>Size: {{ product.available_size }}</p>
      </div>

      <!-- Flavor Selection -->
      <div class="flavor-selection" *ngIf="product.available_flavors.length > 0">
        <label for="flavor">Flavor</label>
        <select id="flavor" class="flavor-dropdown" [(ngModel)]="selectedFlavor" (change)="onFlavorChange()">
          <option *ngFor="let flavor of product.available_flavors" [value]="flavor">{{ flavor }}</option>
        </select>
        <button class="clear-button" (click)="clearFlavor()">Clear</button>
      </div>

      <!-- Stock Status -->
      <div class="stock-indicator">
        <span class="in-stock-icon"></span>
        <span>In stock</span>
      </div>

      <!-- Quantity Controls and Add to Cart -->
      <div class="purchase-controls">
        <div class="quantity-control">
          <button class="quantity-decrease" (click)="decreaseQuantity()">âˆ’</button>
          <input type="number" class="quantity-input" [(ngModel)]="quantity" min="1" />
          <button class="quantity-increase" (click)="increaseQuantity()">+</button>
        </div>
        <button class="add-to-cart-button btn-outline-light orange-btn border-0" (click)="addToCart(product)">ADD TO CART</button>
        <!-- <div *ngIf="showPopUpMessage" class="pop-up-message">
          Item added to cart!
        </div> -->
      </div>

      

      <!-- Product Categories -->
      <div class="product-categories">
        <div>Category: <a [routerLink]="['/category', product.category]">{{ product.category }}</a></div>
        <div>Brand: <a [routerLink]="['/brand', product.brand]">{{ product.brand }}</a></div>
      </div>
    </div>
  </div>

  <!-- Related Products Section -->
  <div class="related-products" *ngIf="similarProducts.length > 0">
    <h2 class="section-title">RELATED PRODUCTS</h2>
    
    <div class="products-grid">
      <div class="product-card" *ngFor="let relatedProduct of similarProducts">
        <!-- Product Image -->
        <div class="product-image">
          <a [routerLink]="['/product', relatedProduct.id]">
            <img [src]="relatedProduct.image" [alt]="relatedProduct.name" />
          </a>
        </div>
        
        <!-- Product Category -->
        <div class="product-categories">
          <a [routerLink]="['/category', relatedProduct.category]">{{ relatedProduct.category }}</a>
        </div>
        
        <!-- Product Title -->
        <div class="product-title">
          <a [routerLink]="['/product', relatedProduct.id]">{{ relatedProduct.name }}</a>
        </div>
        
        <!-- Product Price -->
        <div class="product-price">
          <span class="current-price">{{ relatedProduct.price }} EGP</span>
        </div>
        
        <!-- Product Actions -->
        <div class="product-actions">
          <button class="select-options-button" [routerLink]="['/products', relatedProduct.id]">View Product</button>
        </div>
      </div>
    </div>
  </div>


</div>

